<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Eid Mubarak Wishes</title>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6985722776441624" crossorigin="anonymous"></script>
    <!-- html2canvas library for downloading the card as an image -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        /* --- Base & Animation Styles --- */
        :root {
            --gold: #ffd700;
            --orange: #ff4500;
            --dark-green: #0a1d18;
            --light-text: #f0f0f0;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            text-align: center;
            background: var(--dark-green);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;
            color: #fff;
            overflow: hidden;
            perspective: 1000px; /* For 3D animations */
            transition: background 1s ease;
        }

        .container {
            max-width: 500px;
            width: 90%;
            padding: 30px;
            border-radius: 20px;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(12px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
            position: absolute; /* Needed for smooth transitions */
        }
        
        /* --- New Intro Cover Card --- */
        #cover-card {
            z-index: 1000;
            cursor: pointer;
            transform: translateY(-120vh) rotateX(90deg);
            opacity: 0;
            transition: transform 1.2s cubic-bezier(0.68, -0.55, 0.27, 1.55), opacity 1s ease;
        }
        #cover-card.visible {
            transform: translateY(0) rotateX(0deg);
            opacity: 1;
        }
        #cover-card.hidden {
            transform: translateY(0) rotateX(-90deg) scale(0.8);
            opacity: 0;
            pointer-events: none;
        }
        #cover-card h1 {
            font-size: 2.5em;
            color: var(--gold);
            text-shadow: 0 0 15px var(--gold);
        }
        #cover-card p {
            font-size: 1.2em;
            color: var(--light-text);
        }

        /* --- Setup & Wish Screens --- */
        #section1, #section2 {
            opacity: 0;
            transform: scale(0.95);
            pointer-events: none;
        }
        #section1.visible, #section2.visible {
            opacity: 1;
            transform: scale(1);
            pointer-events: auto;
        }
        
        header h1, #section1 h1 {
            font-size: 2em; margin-bottom: 10px;
            background: linear-gradient(90deg, #f39c12, #e74c3c, #3498db);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        header h2 {
            font-size: 1.3em; margin-top: 0;
            background: linear-gradient(90deg, var(--gold), #ff7e5f);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        
        .input-group { margin-bottom: 15px; }
        input[type="text"] {
            padding: 12px; font-size: 1em; border-radius: 25px;
            background: rgba(255, 255, 255, 0.1); border: 1px solid var(--gold);
            width: 80%; text-align: center; color: #fff; margin-top: 5px;
        }
        input[type="text"]::placeholder { color: rgba(255, 255, 255, 0.6); }

        #wishText {
            font-size: 1.2em; min-height: 100px; display: flex;
            align-items: center; justify-content: center; margin: 20px 0;
        }

        /* --- UI Elements: Buttons, Selectors --- */
        .button-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 10px; margin-top: 20px;
        }
        button {
            padding: 12px 15px; font-size: 1em; border: none;
            border-radius: 25px; cursor: pointer;
            background: linear-gradient(45deg, #4CAF50, #8BC34A);
            color: #fff; font-weight: bold;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        button:hover { transform: scale(1.05); box-shadow: 0 0 15px rgba(139, 195, 74, 0.7); }
        #copyBtn, #whatsappBtn { background: linear-gradient(45deg, #03A9F4, #00BCD4); }
        #downloadBtn { background: linear-gradient(45deg, #9C27B0, #673AB7); }
        #createOwnBtn { background: linear-gradient(45deg, #f44336, #e91e63); }

        #music-selector {
            width: 100%; padding: 10px; border-radius: 10px;
            background: rgba(255, 255, 255, 0.1); border: 1px solid var(--gold);
            color: white; margin-top: 20px; font-size: 0.9em;
        }
        #music-selector option { background-color: #333; }

        /* --- Decorations & Animations --- */
        body.decorated {
            background: linear-gradient(45deg, #132a24, #6d1e00, #4c3b00, #004d26);
            background-size: 400% 400%; animation: gradientBG 20s ease infinite;
        }
        @keyframes gradientBG { 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }
        .decorated #section2 { border: 3px solid transparent; animation: borderPulse 4s infinite; }
        @keyframes borderPulse { 0%,100%{border-color:var(--gold);box-shadow:0 0 20px var(--gold)} 50%{border-color:var(--orange);box-shadow:0 0 30px var(--orange)} }
        .decorated #wishText { text-shadow: 0 0 10px var(--gold), 0 0 20px var(--orange); animation: glow 1.5s infinite alternate; }
        @keyframes glow { from{text-shadow:0 0 10px var(--gold),0 0 20px #fff} to{text-shadow:0 0 20px var(--gold),0 0 40px var(--orange)} }

        #fireworks-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -1; }
        .particle { position: absolute; width: 4px; height: 4px; border-radius: 50%; animation: explode 0.8s ease-out forwards; }
        @keyframes explode { to { transform: translate(var(--x), var(--y)); opacity: 0; } }

        #music-toggle { position: fixed; bottom: 20px; right: 20px; width: 50px; height: 50px; border-radius: 50%; font-size: 1.5rem; background: rgba(255, 215, 0, 0.8); z-index: 100; }
    </style>
</head>
<body>
    <div id="fireworks-container"></div>
    
    <!-- New Intro Cover Card -->
    <div id="cover-card" class="container">
        <h1>An Eid Greeting For You</h1>
        <img src="https://i.pinimg.com/originals/30/f3/15/30f3152783457116743939a797433890.gif" alt="Eid Lantern" style="width: 150px; border-radius: 50%; margin: 20px 0;">
        <p>Click the card to open your message!</p>
    </div>

    <!-- Section 1: Setup Screen -->
    <div id="section1" class="container">
        <h1>Create Your Eid Wish!</h1>
        <div class="input-group">
            <label for="senderNameInput">Your Name:</label><br>
            <input type="text" id="senderNameInput" placeholder="Enter your name">
        </div>
        <div class="input-group">
            <label for="recipientNameInput">Recipient's Name:</label><br>
            <input type="text" id="recipientNameInput" placeholder="Enter their name">
        </div>
        <button onclick="generateCard()">‚ú® Decorate & Send ‚ú®</button>
    </div>

    <!-- Section 2: Decorated Wish Card -->
    <div id="section2" class="container">
        <header>
            <h1>üïãüïå Happy Eid Mubarak ü•Äüéâ</h1>
            <h2 id="userNameHeader"></h2>
        </header>
        <main>
          <p id="wishText"></p>
          <div class="button-grid">
              <button onclick="refreshWish()">New Wish üîÅ</button>
              <button onclick="speakWish()">Speak üîä</button>
              <button id="downloadBtn" onclick="downloadCard()">Download Card ‚¨áÔ∏è</button>
              <button id="createOwnBtn" onclick="createYourOwn()">Create Your Own ‚úèÔ∏è</button>
              <button id="copyBtn" onclick="copyShareLink()">Copy Link üìã</button>
              <button id="whatsappBtn" onclick="shareOnWhatsApp()">Share on WhatsApp üí¨</button>
          </div>
          <select id="music-selector" onchange="changeMusic()"></select>
        </main>
    </div>

    <audio id="eidSound" preload="auto" loop></audio>
    <button id="music-toggle" onclick="toggleMusic()">üéµ</button>

    <script>
        const wishes = [
            "May this Eid bring joy, peace, and prosperity to your life. Eid Mubarak!", "Wishing you and your family a blessed Eid filled with love and happiness.", "On this auspicious occasion, may Allah bless you with happiness and grace your home with warmth and peace.", "Eid Mubarak! May Allah‚Äôs blessings be with you today and always.", "Sending you warm wishes on Eid. May this day bring peace and happiness to everyone.", "May the magic of this Eid bring lots of happiness in your life and decorate it with the colors of heaven!", "Eid is a day to cheer and to laugh with all your heart. It‚Äôs a day to be grateful to Allah for all his heavenly blessings.", "May Allah fulfill all your dreams and hopes. Eid Mubarak!", "May the divine blessings of Allah bring you hope, faith, and joy on Eid-ul-Adha and forever.", "May Allah accept your good deeds, forgive your transgressions and ease the suffering of all people around the globe."
        ];
        
        const musicTracks = [
            { name: "Gentle Oud Melody", url: "https://cdn.pixabay.com/audio/2022/05/27/audio_132c1401b4.mp3" },
            { name: "Uplifting Arabic Tune", url: "https://cdn.pixabay.com/audio/2022/02/12/audio_c684346e91.mp3" },
            { name: "Peaceful Flute", url: "https://cdn.pixabay.com/audio/2022/08/03/audio_51cf59f139.mp3" },
            { name: "Festive Celebration", url: "https://cdn.pixabay.com/audio/2023/04/22/audio_1e37042858.mp3" }
        ];

        let senderName = "Mujtaba Alam";
        let recipientName = "a Dear Friend";
        let fireworksInterval;

        const coverCard = document.getElementById('cover-card');
        const section1 = document.getElementById('section1');
        const section2 = document.getElementById('section2');
        const eidMusic = document.getElementById('eidSound');
        const musicSelector = document.getElementById('music-selector');

        // --- Core App Flow ---
        function showScreen(screen) {
            section1.classList.remove('visible');
            section2.classList.remove('visible');
            screen.classList.add('visible');
        }

        function generateCard() {
            senderName = document.getElementById('senderNameInput').value.trim() || "A Friend";
            recipientName = document.getElementById('recipientNameInput').value.trim() || "a Dear Friend";
            showWishCard();
        }

        function showWishCard() {
            showScreen(section2);
            document.body.classList.add('decorated');
            document.getElementById('userNameHeader').textContent = `From ${senderName} to ${recipientName}!`;
            refreshWish();
            
            if (!fireworksInterval) {
                fireworksInterval = setInterval(createFirework, 1500);
            }
            if (eidMusic.paused) {
                eidMusic.play().catch(() => {});
                document.getElementById('music-toggle').innerHTML = '‚è∏Ô∏è';
            }
        }

        function createYourOwn() {
            showScreen(section1);
            document.body.classList.remove('decorated');
            if (fireworksInterval) {
                clearInterval(fireworksInterval);
                fireworksInterval = null;
            }
            eidMusic.pause();
            document.getElementById('music-toggle').innerHTML = 'üéµ';
        }

        // --- Interactivity Functions ---
        function refreshWish() {
            document.getElementById('wishText').textContent = wishes[Math.floor(Math.random() * wishes.length)];
        }

        function speakWish() {
            const text = `${document.getElementById('userNameHeader').textContent}. ${document.getElementById('wishText').textContent}`;
            window.speechSynthesis.speak(new SpeechSynthesisUtterance(text));
        }

        function downloadCard() {
            const cardElement = document.getElementById('section2');
            const buttonGrid = cardElement.querySelector('.button-grid');
            const musicSelect = cardElement.querySelector('#music-selector');
            
            // Temporarily hide controls for the screenshot
            buttonGrid.style.display = 'none';
            musicSelect.style.display = 'none';

            html2canvas(cardElement, { 
                backgroundColor: '#0a1d18', // Ensure background is captured
                useCORS: true // For external images if any
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `Eid-Card-for-${recipientName}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                // Restore controls
                buttonGrid.style.display = 'grid';
                musicSelect.style.display = 'block';
            });
        }

        // --- Sharing Functions ---
        function copyShareLink() {
            const url = `${window.location.origin}${window.location.pathname}?sender=${encodeURIComponent(senderName)}&recipient=${encodeURIComponent(recipientName)}`;
            navigator.clipboard.writeText(url).then(() => {
                const copyButton = document.getElementById('copyBtn');
                copyButton.textContent = 'Copied!';
                setTimeout(() => { copyButton.textContent = 'Copy Link üìã'; }, 2000);
            });
        }
        
        function shareOnWhatsApp() {
            const url = `${window.location.origin}${window.location.pathname}?sender=${encodeURIComponent(senderName)}&recipient=${encodeURIComponent(recipientName)}`;
            const text = `Hey ${recipientName}! ‚ú®\n\n${senderName} is sending you an Eid wish:\n*"${document.getElementById('wishText').textContent}"*\n\nSee your special animated card here:\n${url}`;
            window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, "_blank");
        }

        // --- Music Functions ---
        function populateMusicSelector() {
            musicTracks.forEach(track => {
                const option = document.createElement('option');
                option.value = track.url;
                option.textContent = track.name;
                musicSelector.appendChild(option);
            });
            eidMusic.src = musicTracks[0].url;
        }

        function changeMusic() {
            eidMusic.src = musicSelector.value;
            eidMusic.play().catch(() => {});
            document.getElementById('music-toggle').innerHTML = '‚è∏Ô∏è';
        }

        function toggleMusic() {
            const musicBtn = document.getElementById('music-toggle');

            if (eidMusic.src && eidMusic.paused) {
                eidMusic.play();
                musicBtn.innerHTML = '‚è∏Ô∏è';
            } else {
                eidMusic.pause();
                musicBtn.innerHTML = 'üéµ';
            }
        }

        // --- Animation Functions ---
        function createFirework() {
            const container = document.getElementById('fireworks-container');
            const x = Math.random() * 90 + 5;
            const y = Math.random() * 50 + 20;
            explode(container, x, y);
        }

        function explode(container, x, y) {
            const particleCount = 50;
            const colors = ['#FFD700', '#FF6347', '#00FF7F', '#1E90FF', '#BA55D3', '#FFFFFF'];
            for (let i = 0; i < particleCount; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                p.style.left = `${x}%`; p.style.top = `${y}%`;
                p.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                const angle = Math.random() * 360, radius = Math.random() * 100 + 50;
                p.style.setProperty('--x', `${Math.cos(angle*(Math.PI/180))*radius}px`);
                p.style.setProperty('--y', `${Math.sin(angle*(Math.PI/180))*radius}px`);
                container.appendChild(p);
                setTimeout(() => p.remove(), 800);
            }
        }
        
        // --- ON PAGE LOAD ---
        window.onload = function() {
            populateMusicSelector();
            const urlParams = new URLSearchParams(window.location.search);
            const urlSender = urlParams.get("sender");
            const urlRecipient = urlParams.get("recipient");
            
            // Show the animated intro card first
            setTimeout(() => coverCard.classList.add('visible'), 100);

            coverCard.addEventListener('click', () => {
                coverCard.classList.add('hidden');
                
                // After the card animates away, decide which screen to show
                setTimeout(() => {
                    if (urlSender) {
                        senderName = decodeURIComponent(urlSender);
                        recipientName = decodeURIComponent(urlRecipient || "a Dear Friend");
                        showWishCard();
                    } else {
                        showScreen(section1);
                    }
                }, 800); // Wait for hide animation to finish
            }, { once: true }); // The event listener only runs once
        };
    </script>
</body>
</html>